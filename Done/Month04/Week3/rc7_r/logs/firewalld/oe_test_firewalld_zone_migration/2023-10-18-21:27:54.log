+ source /root/mugen/libs/locallibs/common_lib.sh
++ python3 --version
++ '[' 0 -eq 0 ']'
++ source /root/mugen/libs/locallibs/common_lib_python.sh
+ main
++ type -t post_test
+ '[' -n function ']'
+ trap post_test EXIT INT HUP TERM
+ rpm -qa
+ grep expect
++ type -t config_params
+ '[' -n '' ']'
++ type -t pre_test
+ '[' -n function ']'
+ pre_test
+ LOG_INFO 'Start to prepare the test environment.'
+ message='Start to prepare the test environment.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Start to prepare the test environment.'
Wed Oct 18 21:27:56 2023 - INFO  - Start to prepare the test environment.
+ P_SSH_CMD --node 2 --cmd 'which sshpass'
+ python3 /root/mugen/libs/locallibs/ssh_cmd.py --node 2 --cmd 'which sshpass'
which: no sshpass in (/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin)
+ [[ x1 != \x\0 ]]
+ P_SSH_CMD --node 2 --cmd 'yum install sshpass -y'
+ python3 /root/mugen/libs/locallibs/ssh_cmd.py --node 2 --cmd 'yum install sshpass -y'
Last metadata expiration check: 1:37:30 ago on Wed Oct 18 19:50:39 2023.
Dependencies resolved.
================================================================================
 Package           Architecture      Version                 Repository    Size
================================================================================
Installing:
 sshpass           riscv64           1.10-1.oe2309           OS            26 k

Transaction Summary
================================================================================
Install  1 Package

Total download size: 26 k
Installed size: 42 k
Downloading Packages:
sshpass-1.10-1.oe2309.riscv64.rpm                40 kB/s |  26 kB     00:00    
--------------------------------------------------------------------------------
Total                                            38 kB/s |  26 kB     00:00     
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Installing       : sshpass-1.10-1.oe2309.riscv64                          1/1 
  Running scriptlet: sshpass-1.10-1.oe2309.riscv64                          1/1 
  Verifying        : sshpass-1.10-1.oe2309.riscv64                          1/1 

Installed:
  sshpass-1.10-1.oe2309.riscv64                                                 

Complete!
+ sshpass_status=0
+ LOG_INFO 'End to prepare the test environment.'
+ message='End to prepare the test environment.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'End to prepare the test environment.'
Wed Oct 18 21:28:14 2023 - INFO  - End to prepare the test environment.
++ type -t run_test
+ '[' -n function ']'
+ run_test
+ LOG_INFO 'Start to run test.'
+ message='Start to run test.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Start to run test.'
Wed Oct 18 21:28:14 2023 - INFO  - Start to run test.
++ firewall-cmd --state
+ CHECK_RESULT running running 0 'firewalld.service not running'
+ actual_result=running
+ expect_result=running
+ mode=0
+ error_log='firewalld.service not running'
+ exit_mode=0
+ '[' -z running ']'
+ '[' 0 -eq 0 ']'
+ test runningx '!=' runningx
+ return 0
+ firewall-cmd --delete-zone=zonetest --permanent
Error: INVALID_ZONE: zonetest
+ firewall-cmd --reload
success
+ firewall-cmd --get-zones
+ grep zonetest
+ CHECK_RESULT 1 0 1 'default firewall zone check fail'
+ actual_result=1
+ expect_result=0
+ mode=1
+ error_log='default firewall zone check fail'
+ exit_mode=0
+ '[' -z 1 ']'
+ '[' 1 -eq 0 ']'
+ test 1x == 0x
+ return 0
+ CMD_String='sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
+ P_SSH_CMD --node 2 --cmd 'sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
+ python3 /root/mugen/libs/locallibs/ssh_cmd.py --node 2 --cmd 'sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
NAME="openEuler"
VERSION="23.09"
ID="openEuler"
VERSION_ID="23.09"
PRETTY_NAME="openEuler 23.09"
ANSI_COLOR="0;31"
+ CHECK_RESULT 0 0 0 'ssh NODE1_IPV4 fail'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='ssh NODE1_IPV4 fail'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ firewall-cmd --new-zone=zonetest --permanent
success
+ firewall-cmd --reload
success
+ firewall-cmd --get-zones
+ grep zonetest
block dmz drop external home internal public trusted work zonetest
+ CHECK_RESULT 0 0 0 'add firewall zone check fail'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='add firewall zone check fail'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ firewall-cmd --zone=zonetest --add-source=10.0.0.3
success
+ firewall-cmd --zone=zonetest --add-port=65535/tcp
success
++ firewall-cmd --list-all --zone=zonetest
++ grep sources
++ awk '{print $NF}'
+ CHECK_RESULT 10.0.0.3 10.0.0.3 0 'add source fail for zonetest'
+ actual_result=10.0.0.3
+ expect_result=10.0.0.3
+ mode=0
+ error_log='add source fail for zonetest'
+ exit_mode=0
+ '[' -z 10.0.0.3 ']'
+ '[' 0 -eq 0 ']'
+ test 10.0.0.3x '!=' 10.0.0.3x
+ return 0
++ firewall-cmd --list-all --zone=zonetest
++ grep '^  ports'
++ awk '{print $NF}'
+ CHECK_RESULT 65535/tcp 65535/tcp 0 'add ports fail for zonetest'
+ actual_result=65535/tcp
+ expect_result=65535/tcp
+ mode=0
+ error_log='add ports fail for zonetest'
+ exit_mode=0
+ '[' -z 65535/tcp ']'
+ '[' 0 -eq 0 ']'
+ test 65535/tcpx '!=' 65535/tcpx
+ return 0
+ P_SSH_CMD --node 2 --cmd 'sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
+ python3 /root/mugen/libs/locallibs/ssh_cmd.py --node 2 --cmd 'sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
ssh: connect to host 10.0.0.2 port 22: No route to host
+ CHECK_RESULT 255 0 1 'ssh NODE1_IPV4 fail. Firewalld zone migration is not supported'
+ actual_result=255
+ expect_result=0
+ mode=1
+ error_log='ssh NODE1_IPV4 fail. Firewalld zone migration is not supported'
+ exit_mode=0
+ '[' -z 255 ']'
+ '[' 1 -eq 0 ']'
+ test 255x == 0x
+ return 0
+ firewall-cmd --delete-zone=zonetest --permanent
success
+ firewall-cmd --reload
success
+ P_SSH_CMD --node 2 --cmd 'sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
+ python3 /root/mugen/libs/locallibs/ssh_cmd.py --node 2 --cmd 'sshpass -p openEuler12#$ ssh -o '\''StrictHostKeyChecking no'\'' root@10.0.0.2 '\''cat /etc/os-release'\'''
NAME="openEuler"
VERSION="23.09"
ID="openEuler"
VERSION_ID="23.09"
PRETTY_NAME="openEuler 23.09"
ANSI_COLOR="0;31"
+ CHECK_RESULT 0 0 0 'ssh NODE1_IPV4 fail'
+ actual_result=0
+ expect_result=0
+ mode=0
+ error_log='ssh NODE1_IPV4 fail'
+ exit_mode=0
+ '[' -z 0 ']'
+ '[' 0 -eq 0 ']'
+ test 0x '!=' 0x
+ return 0
+ LOG_INFO 'End to run test.'
+ message='End to run test.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'End to run test.'
Wed Oct 18 21:29:22 2023 - INFO  - End to run test.
+ CASE_RESULT 0
+ case_re=0
+ test -z ''
+ test 0 -eq 0
+ LOG_INFO 'succeed to execute the case.'
+ message='succeed to execute the case.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'succeed to execute the case.'
Wed Oct 18 21:29:23 2023 - INFO  - succeed to execute the case.
+ exec_result=
+ exit 0
+ post_test
+ LOG_INFO 'Start to restore the test environment.'
+ message='Start to restore the test environment.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'Start to restore the test environment.'
Wed Oct 18 21:29:23 2023 - INFO  - Start to restore the test environment.
+ [[ x0 == \x\0 ]]
+ P_SSH_CMD --node 2 --cmd 'yum remove sshpass -y'
+ python3 /root/mugen/libs/locallibs/ssh_cmd.py --node 2 --cmd 'yum remove sshpass -y'
Dependencies resolved.
================================================================================
 Package          Architecture     Version                   Repository    Size
================================================================================
Removing:
 sshpass          riscv64          1.10-1.oe2309             @OS           42 k

Transaction Summary
================================================================================
Remove  1 Package

Freed space: 42 k
Running transaction check
Transaction check succeeded.
Running transaction test
Transaction test succeeded.
Running transaction
  Preparing        :                                                        1/1 
  Erasing          : sshpass-1.10-1.oe2309.riscv64                          1/1 
  Running scriptlet: sshpass-1.10-1.oe2309.riscv64                          1/1 
  Verifying        : sshpass-1.10-1.oe2309.riscv64                          1/1 

Removed:
  sshpass-1.10-1.oe2309.riscv64                                                 

Complete!
+ LOG_INFO 'End to restore the test environment.'
+ message='End to restore the test environment.'
+ python3 /root/mugen/libs/locallibs/mugen_log.py --level info --message 'End to restore the test environment.'
Wed Oct 18 21:29:33 2023 - INFO  - End to restore the test environment.
